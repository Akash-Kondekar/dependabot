name: Trigger Dependabot Minor Updates

# Ensure you can trigger manually and schedule it
on:
    workflow_dispatch:
    schedule:
        - cron: "0 0 1 */2 *" # every 2 months, day 1 at 00:00 UTC

# Required permissions to create PRs
permissions:
    contents: write
    pull-requests: write

jobs:
    trigger-minor:
        runs-on: ubuntu-latest
        steps:
            - name: Trigger Dependabot Minor Update Job
              run: |
                  echo "Triggering Dependabot minor updates..."
                  curl -X POST \
                    -H "Accept: application/vnd.github+json" \
                    -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
                    https://api.github.com/repos/${{ github.repository }}/dependabot/updates \
                    -d '{
                      "package-ecosystem": "npm",
                      "directory": "/",
                      "target-branch": "develop",
                      "allow": [{
                        "update-type": "version-update:semver-minor"
                      }]
                    }'
