name: Trigger Dependabot Major Updates

# Manual trigger + schedule
on:
    workflow_dispatch:
    schedule:
        - cron: "0 0 1 */6 *" # every 6 months, day 1 at 00:00 UTC

# Required permissions
permissions:
    contents: write
    pull-requests: write

jobs:
    trigger-major:
        runs-on: ubuntu-latest
        steps:
            - name: Trigger Dependabot Major Update Job
              run: |
                  echo "Triggering Dependabot major updates..."
                  curl -X POST \
                    -H "Accept: application/vnd.github+json" \
                    -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
                    https://api.github.com/repos/${{ github.repository }}/dependabot/updates \
                    -d '{
                      "package-ecosystem": "npm",
                      "directory": "/",
                      "target-branch": "main",
                      "allow": [{
                        "update-type": "version-update:semver-major"
                      }]
                    }'
